id: crs-942-190
name: Detects MSSQL code execution and information gathering attempts
tags:
  type: sqli
  crs_id: '942190'
conditions:
  - operation: match_regex
    parameters:
      inputs:
        - $http.server.cookies
        - $http.server.query
        - $http.server.body
        - $http.server.path_params
      regex: >-
        (?i:(?:[\"'`](?:;?\s*?(?:having|select|union)\b\s*?[^\s]|\s*?!\s*?[\"'`\w])|(?:c(?:onnection_id|urrent_user)|database)\s*?\([^\)]*?|u(?:nion(?:[\w(?:\s]*?select|
        select
        @)|ser\s*?\([^\)]*?)|s(?:chema\s*?\([^\)]*?|elect.*?\w?user\()|into[\s+]+(?:dump|out)file\s*?[\"'`]|\s*?exec(?:ute)?.*?\Wxp_cmdshell|from\W+information_schema\W|exec(?:ute)?\s+master\.|\wiif\s*?\())
      options:
        case_sensitive: true
        min_length: 3
transformers: []
action: record
