id: crs-921-160
name: HTTP Header Injection Attack via payload (CR/LF and header-name detected)
tags:
  type: http_protocol_violation
  crs_id: '921160'
conditions:
  - operation: match_regex
    parameters:
      inputs:
        - $http.server.query
        - $http.server.path_params
      regex: >-
        [\n\r]+(?:\s|location|refresh|(?:set-)?cookie|(?:x-)?(?:forwarded-(?:for|host|server)|host|via|remote-ip|remote-addr|originating-IP))\s*:
    options:
      case_sensitive: true
      min_length: 3
transformers:
  - lowercase
action: log
