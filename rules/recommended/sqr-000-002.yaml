id: sqr-000-002
name: 'Server-side Javascript injection: Try to detect obvious JS injection'
tags:
  type: js_code_injection
conditions:
  - operation: match_regex
    parameters:
      inputs:
        - $http.server.query
        - $http.server.body
        - $http.server.path_params
      regex: require\(['"][\w\.]+['"]\)|process\.\w+\([\w\.]*\)|\.toString\(\)
      options:
        min_length: 4
transformers:
  - removeNulls
action: record
