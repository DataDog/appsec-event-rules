id: sqr-000-001
name: 'SSRF: Try to access the credential manager of the main cloud services'
tags:
  type: ssrf
conditions:
  - operation: match_regex
    parameters:
      inputs:
        - server.request.query
        - server.request.body
        - server.request.path_params
      regex: >-
        (?i)^\W*((http|ftp)s?://)?\W*((::f{4}:)?(169|(0x)?0*a9|0+251)\.?(254|(0x)?0*fe|0+376)[0-9a-fx\.:]+|metadata\.google\.internal|metadata\.goog)\W*/
      options:
        min_length: 4
transformers:
  - removeNulls
action: record
